body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background:#2d2d2d; color:#2d2d2d; -webkit-text-size-adjust: 100%; }
.container { max-width: 900px; margin: 2vw auto; padding: min(24px, 4vw); }
.card { background:#ffffff; border:2px solid #dc2626; border-radius: 12px; padding: min(24px, 4vw); box-shadow: 0 10px 30px rgba(220,38,38,.15); }
h1 { margin-top:0; font-size: clamp(24px, 8vw, 48px); font-weight:700; text-align:center; line-height: 1.1; }
.title-black { color: #000000; }
.title-red { color: #dc2626; }
h2 { color:#dc2626; font-size: clamp(16px, 3vw, 18px); font-weight:600; margin: 0 0 16px 0; border-bottom: 2px solid #dc2626; padding-bottom: 8px; }
#page-1 h2 { text-align: center; }
label { display:block; font-weight:600; margin: 14px 0 6px; color:#4a4a4a; font-size: clamp(14px, 2.5vw, 16px); }
input, select { width:100%; padding: min(12px, 2vw) min(14px, 3vw); border-radius:8px; border:2px solid #9ca3af; background:#ffffff; color:#2d2d2d; box-sizing:border-box; font-size: clamp(14px, 2.5vw, 16px); min-height: 44px; }
#target_days { font-size: clamp(80px, 20vw, 240px); padding: min(40px, 6vw); text-align: center; font-weight: 600; width: min(400px, 85vw); margin: 0 auto; display: block; box-sizing: border-box; }
input:focus, select:focus { outline:none; border-color:#dc2626; }
input::placeholder { color:#9ca3af; }
.row { display:grid; grid-template-columns: 1fr 1fr; gap:24px; align-items: start; }
.row-three { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:24px; }
.side-column { display:flex; flex-direction:column; gap:24px; }
.side-column > div { min-height: 80px; }
.actions { margin-top: 24px; text-align:center; }
button, .button { background:#dc2626; color:white; padding: min(14px, 3vw) min(24px, 5vw); border:none; border-radius:8px; font-weight:600; cursor:pointer; text-decoration:none; font-size: clamp(14px, 3vw, 16px); min-height: 44px; touch-action: manipulation; }
button:hover, .button:hover { background:#b91c1c; }
button:active { transform: scale(0.98); }
.hint { color:#6b7280; font-size: 12px; }
.flash { background:#fef2f2; border:2px solid #dc2626; color:#dc2626; padding:12px 16px; border-radius:8px; margin-top: 12px; }
.hidden { display:none; }
.meta { color:#6b7280; margin: 10px 0 18px; font-size: 14px; }
img { max-width:100%; border-radius:8px; border:2px solid #9ca3af; }
.moon, .cam-spin { border: none !important; }

/* Stage styling */
.stage { background:#e5e5e5; border:2px solid #dc2626; border-radius: 12px; padding: 20px; margin: 20px 0; }

/* Progress indicator */
.progress { display:flex; gap: min(8px, 2vw); margin: 12px 0 16px; }
.progress .step { flex:1; text-align:center; border:2px solid #9ca3af; border-radius:999px; padding: min(8px, 2vw) min(10px, 2.5vw); color:#6b7280; font-weight:600; background:#f3f4f6; cursor:pointer; transition: all 0.2s; font-size: clamp(12px, 2.5vw, 14px); min-height: 44px; display: flex; align-items: center; justify-content: center; touch-action: manipulation; }
.progress .step.active { border-color:#dc2626; color:#dc2626; background:#ffffff; box-shadow: 0 4px 12px rgba(220,38,38,.08); }
.progress .step:hover { border-color:#dc2626; }

/* Multi-page interface */
.page { display: none; }
.page.active { display: block; }
.page-navigation { display: flex; justify-content: space-between; margin-top: 24px; }
.nav-button { background:#6b7280; color:white; padding: min(12px, 3vw) min(20px, 4vw); border:none; border-radius:8px; font-weight:600; cursor:pointer; font-size: clamp(14px, 3vw, 16px); min-height: 44px; touch-action: manipulation; }
.nav-button:hover { background:#4b5563; }
.nav-button:disabled { background:#9ca3af; cursor:not-allowed; }
.nav-button.primary { background:#dc2626; }
.nav-button.primary:hover { background:#b91c1c; }
.nav-button:active { transform: scale(0.98); }

/* Price prediction styles */
.prediction-result { text-align: center; }
.prediction-result h2 { margin: 0 0 20px; color: #dc2626; }
.price-display { background: #f9f9f9; border: 2px solid #dc2626; border-radius: 12px; padding: 24px; margin: 20px 0; }
.price-label { display: block; color: #6b7280; font-size: 14px; margin-bottom: 8px; }
.price-value { font-size: 32px; font-weight: 600; color: #dc2626; }
.prediction-details { text-align: left; margin-top: 20px; }
.detail-item { color: #4a4a4a; margin: 8px 0; font-size: 14px; }

/* Loading overlay - centered with moon+camera animation */
.loading { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 9999; background: rgba(45,45,45,0.9); display: flex; align-items: center; justify-content: center; flex-direction: column; }
.loading.hidden { display: none !important; }
.loading-inner { background:#ffffff; border:2px solid #dc2626; border-radius:12px; padding:24px; box-shadow: 0 10px 30px rgba(220,38,38,.25); display:flex; align-items:center; flex-direction: column; gap:16px; }
.loading .loading-text { color:#2d2d2d; font-weight:600; font-size: 16px; text-align: center; }

/* Moon + Camera Animation */
.animation-stage {
  position: relative;
  width: 120px;
  height: 120px;
  background: #ffffff;
}
.animation-stage svg { position:absolute; inset:0; }
.bg-circle { fill:#ffffff; }
.rotor {
  position: absolute; inset: 0;
  display: grid; place-items: center;
  animation: spin-cw 3s linear infinite;
  will-change: transform;
}
.moon {
  width: 100%;
  height: 100%;
  transform-origin: 50% 50%;
  display:block;
}
.cam-carrier {
  position: absolute;
  left: 50%; top: 50%;
  transform: translate(-50%, -50%) translate(17.5px, -5.3px);
  will-change: transform;
}
.cam-spin {
  width: 44px;
  display:block;
  transform-origin: 50% 50%;
  animation: spin-ccw 1.5s linear infinite;
}
@keyframes spin-cw  { to { transform: rotate(360deg); } }
@keyframes spin-ccw { to { transform: rotate(-360deg); } }

/* Validation visuals */
input:invalid:not(:focus):not(:placeholder-shown), select:invalid:not(:focus) { border-color:#dc2626; }

/* Speed selection images */
.speed-selection { display: flex; flex-direction: row; gap: min(20px, 4vw); justify-content: center; margin: 20px 0; flex-wrap: wrap; }
.speed-option { 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  cursor: pointer; 
  transition: all 0.2s;
  text-align: center;
  touch-action: manipulation;
  min-width: 44px;
}
.speed-image {
  width: clamp(60px, 15vw, 80px);
  height: clamp(60px, 15vw, 80px);
  border: 3px solid #9ca3af;
  border-radius: 12px;
  padding: min(12px, 3vw);
  background: #ffffff;
  transition: all 0.2s;
  object-fit: contain;
}
.speed-option:hover .speed-image {
  border-color: #dc2626;
  box-shadow: 0 4px 12px rgba(220,38,38,.15);
}
.speed-option.selected .speed-image {
  border-color: #dc2626;
  background: #fef2f2;
  box-shadow: 0 4px 12px rgba(220,38,38,.25);
}
.speed-option:active {
  transform: scale(0.95);
}
.speed-label {
  margin-top: min(8px, 2vw);
  font-weight: 600;
  color: #4a4a4a;
  font-size: clamp(12px, 2.5vw, 14px);
}
.speed-description {
  margin-top: min(4px, 1vw);
  font-size: clamp(10px, 2vw, 12px);
  color: #6b7280;
}

/* Responsive behavior */
@media (max-width: 768px) {
  .row { grid-template-columns: 1fr; gap: min(16px, 4vw); }
  .side-column { gap: min(16px, 4vw); }
  .side-column > div { min-height: 60px; }
  .stage { padding: min(16px, 4vw); margin: min(16px, 4vw) 0; }
  .page-navigation { margin-top: min(16px, 4vw); gap: min(12px, 3vw); }
}

@media (max-width: 480px) {
  .progress { flex-direction: column; gap: min(8px, 2vw); }
  .progress .step { min-height: 40px; padding: min(6px, 1.5vw) min(8px, 2vw); }
  .speed-selection { gap: min(12px, 3vw); }
  .nav-button { padding: min(10px, 2.5vw) min(16px, 3.5vw); }
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  input, select, button, .nav-button, .progress .step, .speed-option {
    -webkit-appearance: none;
    appearance: none;
    -webkit-tap-highlight-color: transparent;
  }
  
  input[type="number"] {
    -webkit-appearance: none;
    appearance: none;
    -moz-appearance: textfield;
  }
  
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    appearance: none;
    margin: 0;
  }
}
